.. ##
.. ## Copyright (c) 2022-23, Lawrence Livermore National Security, LLC and
.. ## other RADIUSS Project Developers. See the top-level COPYRIGHT file for
.. ## details.
.. ##
.. ## SPDX-License-Identifier: (MIT)
.. ##

.. _user_how_to-label:

#########
How To...
#########

This section describes how to perform various maintenance tasks once you have
the RADIUSS Shared CI framework set up for your project.


.. _update-shared-ci:

===========================
Update the CI configuration
===========================

Updating RADIUSS Shared CI
==========================

Updating RADIUSS shared CI is straightforward. the Shared CI version to use is
defined by a the reference (``ref:`` section) in the remote includes. We
recommend using a variable to set this reference only once, and then update
radiuss-shared-ci easily.

===================================
Leverage Spack in RADIUSS Shared CI
===================================

Initially, the RADIUSS Shared CI infrastructure was designed for RADIUSS
projects also using Spack to describe the toolchain and build the dependencies.
This "build infrastructure" is defined in `RADIUSS Spack Configs`_
documentation.

Spack provides a unified context to express toolchains, machine setup, and
build sequence. Spack is increasingly used to install dependency stacks of
large simulation codes.

Using RADIUSS Spack Configs allows projects to easily share the full context of
their builds.

.. figure:: images/Full-CI-Infrastructure.png
   :scale: 18 %
   :align: center

   The Shared CI Infrastructure is project agnostic. It is tuned for
   open-source projects hosted on GitHub and willing to run CI on a GitLab
   instance. It currently only supports a handful of Livermore Computing
   machines, but more could be added without disrupting the design.

If you were to adopt the full infrastructure, setting up the build
infrastructure would be done following two steps:

1. **Use Spack to install dependencies and configure a project build.**
2. **Setup your build system so that it accepts the configuration file
   generated by Spack.**


.. _RADIUSS Spack Configs: https://radiuss-spack-configs.readthedocs.io/en/latest/index.html
.. _radiuss-spack-configs: https://github.com/LLNL/radiuss-spack-configs
.. _Uberenv: https://github.com/LLNL/uberenv
.. _Spack: https://github.com/spack/spack
